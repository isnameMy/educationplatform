<!-- frontend/templates/student/course_detail.html -->
{% extends "base.html" %}
{% block content %}

<!-- Секция "Сводка" -->
<div class="card card-hover mb-4">
  <div class="card-body">
    <h2 class="card-title">{{ course.title }}</h2>
    <p class="card-text text-muted">{{ course.description }}</p>
    <p class="card-text"><small class="text-muted">Автор: {{ course.author or "Неизвестно" }}</small></p>

    <!-- Прогресс -->
    <div class="mb-3">
      <div class="d-flex justify-content-between mb-1">
        <strong>Прогресс: {{ progress }} / {{ total }} заданий</strong>
        <span>{{ (progress / total * 100) | round(1) if total > 0 else 0 }}%</span>
      </div>
      <div class="progress" style="height: 12px;">
        <div class="progress-bar" role="progressbar" style="width: {{ (progress / total * 100) if total > 0 else 0 }}%"></div>
      </div>
    </div>

    <!-- Статистика -->
    <div class="row">
      <div class="col-md-4">
        <div class="card bg-light">
          <div class="card-body text-center">
            <h5 class="card-title">{{ stats.videos or 0 }}</h5>
            <p class="card-text">Видео</p>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card bg-light">
          <div class="card-body text-center">
            <h5 class="card-title">{{ stats.assignments or 0 }}</h5>
            <p class="card-text">Практик</p>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card bg-light">
          <div class="card-body text-center">
            <h5 class="card-title">{{ stats.texts or 0 }}</h5>
            <p class="card-text">Теории</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Кнопка "Перейти к первому модулю" -->
    {% if first_module %}
      <div class="d-grid gap-2 col-6 mx-auto mt-4">
        <a href="/student/course/{{ course.id }}/module/{{ first_module.id }}" class="btn btn-primary btn-grad text-white py-2">
          <i class="bi bi-journal-check me-2"></i> Начать курс
        </a>
      </div>
    {% else %}
      <div class="alert alert-info mt-4">
        Модули для этого курса пока не добавлены.
      </div>
    {% endif %}

  </div>
</div>

<!-- Рекомендации (если есть) -->
{% if recommendations %}
<div class="card card-hover mb-4" style="background: linear-gradient(135deg, #4361ee 0%, #3a0ca3 100%); color: white;">
  <div class="card-body">
    <h5 class="mb-3"><i class="bi bi-stars me-2"></i> Персональные рекомендации</h5>
    {% for rec in recommendations %}
    <div class="d-flex align-items-start mb-3 pb-2 border-bottom border-white-50">
      <div class="me-3 mt-1">
        <span class="badge bg-light text-dark">✨</span>
      </div>
      <div>
        <h6 class="mb-1">{{ rec.title }}</h6>
        <p class="mb-0 opacity-75">{{ rec.reason }}</p>
      </div>
    </div>
    {% endfor %}
  </div>
</div>
{% endif %}

{% endblock %}